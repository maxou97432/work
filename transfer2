# Création des colonnes standardisées
base_ml["PB"] = (
    base_ml["NB_PIECES_RANGE"]
    .astype(str)
    .str.strip()
    .str[:3]
    .str.upper()
)
base_ml["TYPE_BIEN"] = base_ml["TYPE_BIEN"].astype(str).str.strip().str.upper()

# Supprimer les lignes incohérentes (TYPE_BIEN ≠ PB)
mask = base_ml["TYPE_BIEN"] != base_ml["PB"]
print("Lignes supprimées :", mask.sum())

base_ml = base_ml.loc[~mask].copy()

# Vérification
print(base_ml[["TYPE_BIEN", "NB_PIECES_RANGE", "PB"]].head())
