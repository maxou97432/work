j = base_ml.groupby('YEAR')['ID'].count()
print(f"Répartition du nombre de transactions de bien par an :{j}")

j.plot(kind = 'bar', stacked=False)
plt.title("Évolution annuelle du nombre de transactions ")
plt.xlabel("Année")
plt.ylabel("Nombre de transactions")
plt.tight_layout()
plt.show()


df_grouped = base_ml.groupby(['YEAR', 'SOURCE'])['ID'].count().reset_index(name='Nombre_transactions')
total_per_year = df_grouped.groupby('YEAR')['Nombre_transactions'].sum()

pivot_df = df_grouped.pivot(index='YEAR', columns='SOURCE', values='Nombre_transactions')
pourcentage_df = pivot_df.div(total_per_year, axis=0) * 100
pourcentage_df.plot(kind='bar', stacked=False)
plt.title("Évolution annuelle du pourcentage du nombre de transactions par source")
plt.xlabel("Année")
plt.ylabel("Nombre de transactions")
plt.legend(title="Source")
plt.tight_layout()
plt.show()
