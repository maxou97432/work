fusion["Prix moyen glissant 12 mois - Univ Elem", "Prix moyen glissant 12 mois - LPI/IAD","Prix moyen glissant 12 mois - CL"]

corr_prix = merge["Prix moyen glissant 12 mois - LPI/IAD"].corr(merge["Prix moyen glissant 12 mois - CL"])
print("Corrélation prix du m2", corr_prix)

diff_prix = merge["Prix moyen glissant 12 mois - LPI/IAD"] - merge["Prix moyen glissant 12 mois - CL"]
print(diff_prix.describe())

from scipy.stats import linregress

df_valid = merge.dropna(subset=["Prix moyen glissant 12 mois - LPI/IAD", "Prix moyen glissant 12 mois - CL"])

slope, intercept, r_value, p_value, std_err = linregress(
    df_valid["Prix moyen glissant 12 mois - LPI/IAD"],
    df_valid["Prix moyen glissant 12 mois - CL"]
)

print(f"Pente = {slope:.3f}, Intercept = {intercept:.2f}, R² = {r_value**2:.3f}")

diff_prix.hist(bins=30)
plt.axvline(0, color='red', linestyle='--')
plt.title('Distribution des écarts de prix du m2')
plt.show()

plt.figure(figsize=(10,10))
plt.scatter(merge["Prix moyen glissant 12 mois - LPI/IAD"], merge["Prix moyen glissant 12 mois - CL"], alpha= 0.6)
plt.axline((0,0), slope = 1, color = "red", linestyle = "--")
plt.xlabel("Prix moyen glissant 12 mois - LPI/IAD")
plt.ylabel("Prix moyen glissant 12 mois - CL")
plt.title("Comparaison des prix du m2")
plt.grid(True)
plt.show()

from scipy.stats import ttest_rel
df_valid = merge.dropna(subset=["Prix moyen glissant 12 mois - LPI/IAD", "Prix moyen glissant 12 mois - CL"])
stat, pval = ttest_rel(df_valid["Prix moyen glissant 12 mois - LPI/IAD"], df_valid["Prix moyen glissant 12 mois - CL"])
print("p-value :", pval)
