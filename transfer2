mon fichier py:
 import sys
import os
current_dir = os.path.dirname(__file__)
parent_dir = os.path.abspath(os.path.join(current_dir, '..'))
sys.path.append(parent_dir)

import pandas as pd
import pickle
import matplotlib.pyplot as plt
from datetime import datetime
import logging
import math
from datetime import timedelta, datetime
from dateutil.relativedelta import relativedelta
from classe import (DateOffset,
                         ImportRecentData,
                         CalcMetaNum,
                         EffectifsParMailleGeo,
                         DefMailleGeoCITY,
                         DetectAno,
                         detect_ano_ml
)
import numpy as np
import plotly.express as px
import plotly.io as pio
import pandas as pd
import time

import os

# Dossier de sortie
output_dir = os.path.join(os.path.dirname(__file__), "results")
os.makedirs(output_dir, exist_ok=True)







pio.renderers.default = "notebook"  


################ Importation de la base ################
start_time = time.time()
df = pd.read_parquet("Z:\data\cl_estim\cleaned_data\df_transac_clean.parquet")
end_time = time.time()
print(f"Temps d'importation : {end_time - start_time:.2f} secondes")

# periode_reference: paramètre permettant de choisir le mois de référence 
periode_reference = None # à changer en fonction de la plage de temps souhaitée
ref_date = periode_reference or df["DATE"].max()

date_max = (ref_date.replace(day = 1))
date_min = (date_max - relativedelta(years= 10))


start_time = time.time()
base_ml, outliers = detect_ano_ml(input_df=df, date_min = date_min, date_max = date_max, type_bien = None) #Algorithme de détection d'anomalies, détaillé dans classe.py
end_time = time.time()
print(f"Temps de détections d'anomalies : {end_time - start_time:.2f} secondes")

mon fichier notebook:
import pandas as pd
import pickle
import matplotlib.pyplot as plt
from datetime import datetime
import logging
import math



# NOMBRE D'ANNEES RECENTES A IMPORTER (N DERNIERES ANNEES)
N_YEARS = 3  # pour le modele ML


df = pd.read_parquet("Z:\data\cl_estim\cleaned_data\df_transac_clean.parquet")
print(df.head())
from datetime import timedelta, datetime
from dateutil.relativedelta import relativedelta
from prez.classe import (DateOffset,
                         ImportRecentData,
                         CalcMetaNum,
                         EffectifsParMailleGeo,
                         DefMailleGeoCITY,
                         DetectAno,
                         detect_ano_ml

)
import numpy as np
import plotly.express as px
import plotly.io as pio
import pandas as pd
pio.renderers.default = "notebook"  
base_ml, outliers = detect_ano_ml(input_df=df, date_min = None, date_max = None, type_bien = None)
  
