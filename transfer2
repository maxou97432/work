def ensure_monthly_and_interpolate(g):
    # g est un DataFrame d'une (Ville, TYPE_BIEN)
    g = g.set_index(col_date).sort_index()
    # index complet mensuel du min au max
    full_idx = pd.date_range(g.index.min(), g.index.max(), freq="MS")
    g = g.reindex(full_idx)
    # conserver les métadonnées de groupe
    g[col_ville] = g[col_ville].ffill().bfill()
    g[col_type]  = g[col_type].ffill().bfill()
    # interpolation temporelle du prix (si des mois manquent)
    g[col_prix] = g[col_prix].interpolate(method="time")
    return g.reset_index().rename(columns={"index": "Periode"})
