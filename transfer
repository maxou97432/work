# On suppose que tu as deux DataFrames :
# df_prix_CL = données Crédit Logement (département, type de bien, prix)
# df_prix_MA = données Meilleurs Agents (département, type de bien, prix)

# Harmonisation des colonnes (adapter si nécessaire)
df_prix_CL = df_prix_CL.rename(columns={"mean_6m": "Prix_CL"})
df_prix_MA = df_prix_MA.rename(columns={"Prix_m2": "Prix_MA"})  # adapter le nom exact

# Fusion des deux sources
df_comparaison = pd.merge(
    df_prix_CL[["Département", "CD_TYP_BIEN", "Prix_CL"]],
    df_prix_MA[["Département", "CD_TYP_BIEN", "Prix_MA"]],
    on=["Département", "CD_TYP_BIEN"],
    how="inner"
)

# Optionnel : calcul des écarts
df_comparaison["Ecart_abs"] = df_comparaison["Prix_CL"] - df_comparaison["Prix_MA"]
df_comparaison["Ecart_%"] = (
    (df_comparaison["Prix_CL"] - df_comparaison["Prix_MA"]) / df_comparaison["Prix_MA"] * 100
).round(2)

# Affichage côte à côte
import pandas as pd
pd.set_option("display.max_rows", 50)
pd.set_option("display.max_columns", None)

df_comparaison.head(20)
