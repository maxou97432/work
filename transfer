{
	"name": "DatabaseError",
	"message": "Execution failed on sql 'SELECT DISTINCT *
    FROM a.BIENS.dbo.TI_VILLE JOIN b.Biens.dbo.EFFECTIFS_VILLES
    ON a.VILLE = b.LL_VILLE': ('42000', \"[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Impossible de trouver le serveur 'a' dans sysservers. Vérifiez que le nom du serveur correct a été spécifié. Si nécessaire, exécutez la procédure stockée sp_addlinkedserver pour ajouter ce serveur à sysservers. (7202) (SQLExecDirectW)\")",
	"stack": "---------------------------------------------------------------------------
ProgrammingError                          Traceback (most recent call last)
File ~\\AppData\\Roaming\\Python\\Python311\\site-packages\\pandas\\io\\sql.py:2664, in SQLiteDatabase.execute(self, sql, params)
   2663 try:
-> 2664     cur.execute(sql, *args)
   2665     return cur

ProgrammingError: ('42000', \"[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Impossible de trouver le serveur 'a' dans sysservers. Vérifiez que le nom du serveur correct a été spécifié. Si nécessaire, exécutez la procédure stockée sp_addlinkedserver pour ajouter ce serveur à sysservers. (7202) (SQLExecDirectW)\")

The above exception was the direct cause of the following exception:

DatabaseError                             Traceback (most recent call last)
Cell In[27], line 25
     22 df_ti_dept_all
     23 current_year = datetime.now().year
---> 25 db_ti_ville = pd.read_sql_query(
     26     f\"\"\"SELECT DISTINCT *
     27     FROM a.BIENS.dbo.TI_VILLE JOIN b.Biens.dbo.EFFECTIFS_VILLES
     28     ON a.VILLE = b.LL_VILLE\"\"\" 
     29     ,conn)

File ~\\AppData\\Roaming\\Python\\Python311\\site-packages\\pandas\\io\\sql.py:528, in read_sql_query(sql, con, index_col, coerce_float, params, parse_dates, chunksize, dtype, dtype_backend)
    525 assert dtype_backend is not lib.no_default
    527 with pandasSQL_builder(con) as pandas_sql:
--> 528     return pandas_sql.read_query(
    529         sql,
    530         index_col=index_col,
    531         params=params,
    532         coerce_float=coerce_float,
    533         parse_dates=parse_dates,
    534         chunksize=chunksize,
    535         dtype=dtype,
    536         dtype_backend=dtype_backend,
    537     )

File ~\\AppData\\Roaming\\Python\\Python311\\site-packages\\pandas\\io\\sql.py:2728, in SQLiteDatabase.read_query(self, sql, index_col, coerce_float, parse_dates, params, chunksize, dtype, dtype_backend)
   2717 def read_query(
   2718     self,
   2719     sql,
   (...)   2726     dtype_backend: DtypeBackend | Literal[\"numpy\"] = \"numpy\",
   2727 ) -> DataFrame | Iterator[DataFrame]:
-> 2728     cursor = self.execute(sql, params)
   2729     columns = [col_desc[0] for col_desc in cursor.description]
   2731     if chunksize is not None:

File ~\\AppData\\Roaming\\Python\\Python311\\site-packages\\pandas\\io\\sql.py:2676, in SQLiteDatabase.execute(self, sql, params)
   2673     raise ex from inner_exc
   2675 ex = DatabaseError(f\"Execution failed on sql '{sql}': {exc}\")
-> 2676 raise ex from exc

DatabaseError: Execution failed on sql 'SELECT DISTINCT *
    FROM a.BIENS.dbo.TI_VILLE JOIN b.Biens.dbo.EFFECTIFS_VILLES
    ON a.VILLE = b.LL_VILLE': ('42000', \"[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Impossible de trouver le serveur 'a' dans sysservers. Vérifiez que le nom du serveur correct a été spécifié. Si nécessaire, exécutez la procédure stockée sp_addlinkedserver pour ajouter ce serveur à sysservers. (7202) (SQLExecDirectW)\")"
}
