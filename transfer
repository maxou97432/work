df_MA[['Numero', 'Nom']] = df_MA['Département'].str.split(' - ', 1, expand=True)
df_MA.drop(columns=['Département', 'Loyer m2 moyen', 'Loyer m2 moyen.1'], inplace=True)
df_MA = df_MA[df_MA['Numero'].isin(departments_to_keep)]
df_MA.set_index('Nom', inplace=True)
result = df_MA.merge(pivot_3m, left_index=True, right_index=True)

# TODO : ajouter Tableau comparatif des prix par mètre carré selon Crédit Logement (3 mois) et Meilleurs Agents : result




columns_to_rename = {
    result.columns[0]: 'Appartment',
    result.columns[1]: 'Maison',
    result.columns[3]: 'Appartement ',
    result.columns[4]: 'Maison '
}

result.rename(columns=columns_to_rename, inplace=True)

result = result[['Appartment', 'Maison', 'Appartement ', 'Maison ']]





header = pd.MultiIndex.from_tuples([
    ('Meilleur Agent', 'Appartement'),
    ('Meilleur Agent', 'Maison'),
    ('Crédit Logement', 'Appartement '),
    ('Crédit Logement', 'Maison ')
])
result.columns = header

print(result)
