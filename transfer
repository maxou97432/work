# On met le nom du département en index directement
df_select = df_select.set_index("Départements")

# Pivot Meilleurs Agents (Appart / Maison)
pivot_MA = df_select.pivot_table(
    values=["Prix m2 moyen (appartements)", "Prix m2 moyen (maisons)"],
    index="Départements"
)

# Fusion avec Crédit Logement (déjà pivoté dans pivot_3m)
result = pivot_MA.merge(pivot_3m, left_index=True, right_index=True)

# Renommer joliment
result.columns = pd.MultiIndex.from_tuples([
    ("Meilleurs Agents", "Appartement"),
    ("Meilleurs Agents", "Maison"),
    ("Crédit Logement", "Appartement"),
    ("Crédit Logement", "Maison")
])

print(result.head())
